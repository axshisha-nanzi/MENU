<script>
    // 1. 請確認這段網址結尾是 gid=0
    const URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSKAYY3Eeo-4GAqI0URzEcIZGt2eRbRlPC8UeVv-DWRde7RDVY3xSssQ4I_vVrlfY1ZqucJOmTisSaC/pub?gid=0&single=true&output=csv&t=' + Date.now();

    async function loadData() {
        try {
            const res = await fetch(URL);
            const text = await res.text();
            const rows = text.split(/\r?\n/).filter(r => r.trim().length > 0);
            const items = [];

            for (let i = 1; i < rows.length; i++) {
                // 高級解析：處理描述裡的逗號
                const c = rows[i].split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(v => v.replace(/^"|"$/g, '').trim());
                
                // 根據您的截圖：
                // c[0] 是 A 欄 (空的)
                // c[1] 是 B 欄 (category)
                // c[2] 是 C 欄 (subcategory)
                // c[3] 是 D 欄 (name_zh) -> 這是判斷有沒有資料的重點
                
                if (c[3] && c[3] !== "") { 
                    items.push({
                        cat: c[1] || "其他",
                        sub: c[2] || "",
                        zh: c[3],
                        en: c[4] || "",
                        price: c[5] || "",
                        desc: c[6] || ""
                    });
                }
            }

            if (items.length > 0) {
                render(items);
            } else {
                document.getElementById('content').innerHTML = '<div style="text-align:center;padding:50px;">抓取成功但內容格式不符，請檢查 B 欄到 G 欄是否有資料。</div>';
            }
        } catch (e) {
            document.getElementById('content').innerHTML = '<div style="text-align:center;padding:50px;">連線失敗。</div>';
        }
    }
    // ... 其餘渲染代碼保持不變 ...
</script>
